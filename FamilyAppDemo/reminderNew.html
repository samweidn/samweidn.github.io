<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family App Demo</title>
    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <!-- styles -->
    <link rel="stylesheet" href="css/familyapp.css">
</head>
<div class="phonescreen">

    <body>
        <!-- HEADER -->
        <header class="fixed-top">
            <div class="logo">
                <p>Family Connnection</p>
            </div>
            <div class="accountDiv">
                <img class="accountIconImage" src="images/account.jpg" alt="">
                <p>Account</p>
            </div>
        </header>

        <!-- MAIN CONTENT -->
        <main class="container">
            <div class="breadcrumbPageTitle">
                <h2>Reminders</h2>
                <div style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='currentColor'/%3E%3C/svg%3E&#34;);"
                    aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="reminder.html">Reminders</a></li>
                        <li class="breadcrumb-item active" aria-current="page">New Reminder</li>
                    </ol>
                </div>
            </div>
            <form class="row g-3 needs-validation" novalidate> <!--action="reminder.html"-->
                <div class="col-md-12">
                    <label for="notificationName" class="form-label">Reminder Name</label>
                    <input type="text" class="form-control" id="notificationName" name="notificationName"
                        placeholder="Name your reminder" required>
                    <div class="invalid-feedback">
                        You must enter a reminder name.
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="input-group mb-3">
                        <label class="input-group-text" for="calendarEvent">
                            <svg fill="#000000" width="25px" height="25px" viewBox="-6 0 32 32" version="1.1"
                                xmlns="http://www.w3.org/2000/svg">
                                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                <g id="SVGRepo_iconCarrier">
                                    <title>paperclip</title>
                                    <path
                                        d="M4.040 26.96c-1.040 0-2.080-0.4-2.88-1.2-1.6-1.56-1.6-4.16 0-5.76l11.080-11.040c0.96-0.96 2.56-0.96 3.52 0 0.48 0.48 0.72 1.080 0.72 1.76s-0.24 1.28-0.72 1.76l-8.8 8.72c-0.32 0.32-0.84 0.32-1.2 0-0.32-0.32-0.32-0.84 0-1.2l8.76-8.76c0.16-0.16 0.24-0.36 0.24-0.56s-0.080-0.4-0.24-0.56c-0.32-0.32-0.84-0.32-1.12 0l-11.040 11.080c-0.92 0.92-0.92 2.48 0 3.4s2.48 0.92 3.4 0l11.040-11.080c0.76-0.76 1.16-1.76 1.16-2.84s-0.4-2.080-1.16-2.84c-1.56-1.56-4.080-1.56-5.64 0l-8.76 8.8c-0.32 0.32-0.84 0.32-1.2 0-0.32-0.32-0.32-0.84 0-1.2l8.8-8.76c2.2-2.2 5.8-2.2 8.040 0 1.080 1.080 1.68 2.48 1.68 4s-0.6 2.96-1.68 4l-11.080 11.080c-0.8 0.8-1.8 1.2-2.92 1.2z">
                                    </path>
                                </g>
                            </svg>Event</label>
                        <select class="form-select" id="calendarEvent" name="linkedEventName">
                            <option value="" selected></option>
                            <option id="11" value="11">Interview at Market and James</option>
                            <option id="12" value="12">Thanksgiving @ Aunt Carol's</option>
                            <option id="13" value="13">Driver License Test</option>
                            <option id="14" value="14">Soccer Game</option>
                        </select>
                    </div>
                </div>
                <div class="col-6">
                    <label for="notificationDate" class="form-label">Reminder Date</label>
                    <input type="date" class="form-control" id="notificationDate" name="notificationDate" value=""
                        required>
                    <div class="invalid-feedback">
                        You must pick a date for your reminder.
                    </div>
                </div>
                <div class="col-6">
                    <label for="notificationTime" class="form-label">Time</label>
                    <input type="time" class="form-control" id="notificationTime" name="notificationTime" value=""
                        required>
                    <div class="invalid-feedback">
                        You must set a time for your reminder.
                    </div>
                </div>
                <div class="col-6">
                    <label for="notificationFrequency" class="col-sm-2 col-form-label">Repeat</label>
                    <select class="form-select" aria-label="frequency select" id="notificationFrequency"
                        name="notificationFrequency">
                        <option value="" selected></option>
                        <option value="Daily">Daily</option>
                        <option value="Weekly">Weekly</option>
                        <option value="Monthly">Monthly</option>
                    </select>
                </div>
                <div class="col-6">
                    <label for="notificationWho" class="col-sm-2 col-form-label">Person</label>
                    <select class="form-select" aria-label="frequency select" id="notificationWho"
                        name="notificationWho">
                        <option value="" selected></option>
                        <option value="Sarah">Sarah</option>
                        <option value="Alice">Alice</option>
                        <option value="Mom">Mom</option>
                        <option value="Dad">Dad</option>
                    </select>
                </div>
                <div class="col-md-12">
                    <p>Connection Method:</p>
                    <div class="d-flex justify-content-around">
                        <div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="contactMethod"
                                    id="contactMethod_Phone" value="Phone">
                                <label class="form-check-label" for="contactMethod_Phone">
                                    Phone
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="contactMethod"
                                    id="contactMethod_Email" value="Email">
                                <label class="form-check-label" for="contactMethod_Email">
                                    Email
                                </label>
                            </div>
                        </div>
                        <div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="contactMethod"
                                    id="contactMethod_Text" value="Text">
                                <label class="form-check-label" for="contactMethod_Text">
                                    Text
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="contactMethod"
                                    id="contactMethod_Facetime" value="Facetime" checked>
                                <label class="form-check-label" for="contactMethod_Facetime">
                                    Facetime
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="form-floating">
                        <textarea class="form-control" placeholder="Leave a comment here" id="notes"
                            name="notes"></textarea>
                        <label for="notes">Notes</label>
                    </div>
                </div>
                <div class="col-12 d-flex justify-content-around mt-5">
                    <a class="btn btn-danger" href="reminder.html">Cancel</a>
                    <button class="btn btn-primary" type="submit">Create Reminder</button>
                </div>
            </form>
        </main>

        <!-- NAVIGATION -->
        <nav class="fixed-bottom">
            <ul>
                <a href="Index.html">
                    <li>
                        <img src="" alt=""></img>
                        <p>Family</p>
                    </li>
                </a>
                <a href="map.html">
                    <li>
                        <img src="" alt=""></img>
                        <p>Map</p>
                    </li>
                </a>
                <a href="calendar.html">
                    <li>
                        <img src="" alt="">
                        <p>Calendar</p>
                    </li>
                </a>
                <a href="reminder.html">
                    <li>
                        <img src="" alt=""></img>
                        <p>Reminders</p>
                    </li>
                </a>
            </ul>
        </nav>

        <!-- Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
        <script>
            // Example starter JavaScript for disabling form submissions if there are invalid fields
            (function () {
                'use strict'

                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                var forms = document.querySelectorAll('.needs-validation')

                // Loop over them and prevent submission
                Array.prototype.slice.call(forms)
                    .forEach(function (form) {
                        form.addEventListener('submit', function (event) {
                            event.preventDefault();
                            if (form.checkValidity()) {
                                event.stopPropagation()

                                const formData = new FormData(form); // Create a FormData object from the form
                                const formObject = Object.fromEntries(formData.entries());

                                const dateOptions = {
                                    year: 'numeric',
                                    month: 'long',
                                    day: 'numeric'
                                };
                                let dateToBeFormatted = new Date(formObject.notificationDate);
                                dateToBeFormatted.setDate(dateToBeFormatted.getDate() + 1);
                                const formattedDate1 = new Intl.DateTimeFormat('en-US', dateOptions).format(dateToBeFormatted);

                                let allReminders = JSON.parse(sessionStorage.getItem('jsonReminders'));
                                let reminder = {
                                    name: formObject.notificationName,
                                    who: formObject.notificationWho,
                                    dateValue: formObject.notificationDate,
                                    date: formattedDate1,
                                    time: formObject.notificationTime,
                                    contactmethod: formObject.contactMethod,
                                    frequency: formObject.notificationFrequency,
                                    linkedevent: '',
                                    linkedeventId: formObject.linkedEventName,
                                    notes: formObject.notes
                                }

                                if (reminder.linkedeventId != null) {

                                    reminder.linkedevent = document.getElementById(formObject.linkedEventName).innerText;

                                    let allFamilyMemberEvents = JSON.parse(sessionStorage.getItem('jsonAllFamilyMemberEvents'));
                                    let eventToUpdate = allFamilyMemberEvents.find(event => event.uniqueId == reminder.linkedeventId);
                                    if (eventToUpdate != null) {
                                        eventToUpdate.reminderSet = true;
                                    }
                                    sessionStorage.setItem('jsonAllFamilyMemberEvents', JSON.stringify(allFamilyMemberEvents));
                                }

                                allReminders.push(reminder);
                                const jsonAllReminders = JSON.stringify(allReminders);
                                sessionStorage.setItem("jsonReminders", jsonAllReminders);
                                window.location.href = "reminder.html";
                            }
                            form.classList.add('was-validated');


                        }, false)
                    })
            })()
        </script>

    </body>
</div>

</html>

<script>
    setNotificationDetails();
    function setNotificationDetails() {
        let notificationDetails = JSON.parse(sessionStorage.getItem("jsonNotificationDetails"));
        if (notificationDetails != undefined) {
            document.getElementById("calendarEvent").value = notificationDetails.notificationEventId;
            document.getElementById("notificationDate").value = notificationDetails.notificationDate;
            document.getElementById("notificationWho").value = notificationDetails.notificationPerson;
        }
    }


</script>